#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>

void print_banner() {
    printf("\n");
    printf("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n");
    printf("â•‘    â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—                 â•‘\n");
    printf("â•‘    â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘                 â•‘\n");
    printf("â•‘    â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘                 â•‘\n");
    printf("â•‘    â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘                 â•‘\n");
    printf("â•‘    â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘                 â•‘\n");
    printf("â•‘    â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•                 â•‘\n");
    printf("â•‘                                                           â•‘\n");
    printf("â•‘         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—        â•‘\n");
    printf("â•‘         â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•        â•‘\n");
    printf("â•‘         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—          â•‘\n");
    printf("â•‘         â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•          â•‘\n");
    printf("â•‘         â–ˆâ–ˆâ•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—        â•‘\n");
    printf("â•‘         â•šâ•â•      â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•        â•‘\n");
    printf("â•‘                                                           â•‘\n");
    printf("â•‘              ğŸ® GAME SCORE VALIDATOR v2.1 ğŸ®             â•‘\n");
    printf("â•‘                  Authenticated System                     â•‘\n");
    printf("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("\n");
}

void show_menu() {
    printf("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n");
    printf("â”‚                    ğŸ•¹ï¸  MAIN MENU  ğŸ•¹ï¸                    â”‚\n");
    printf("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n");
    printf("â”‚  [1] Validate New High Score                           â”‚\n");
    printf("â”‚  [2] Check Game Statistics                             â”‚\n");
    printf("â”‚  [3] Backup Score Database                             â”‚\n");
    printf("â”‚  [4] System Diagnostics                               â”‚\n");
    printf("â”‚  [5] Exit                                              â”‚\n");
    printf("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n");
    printf("\nğŸ’« Select option: ");
}

void validate_score() {
    char player_name[100];
    int score;
    char game_name[100];
    
    printf("\nğŸ¯ SCORE VALIDATION MODULE\n");
    printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    
    printf("ğŸ® Game name: ");
    fgets(game_name, sizeof(game_name), stdin);
    game_name[strcspn(game_name, "\n")] = 0;
    
    printf("ğŸ† Player name: ");
    fgets(player_name, sizeof(player_name), stdin);
    player_name[strcspn(player_name, "\n")] = 0;
    
    printf("â­ Score: ");
    scanf("%d", &score);
    getchar(); // consume newline
    
    printf("\nâœ¨ Validating score for %s in %s...\n", player_name, game_name);
    printf("ğŸ” Running integrity check...\n");
    
    // VulnÃ©rabilitÃ© : appel Ã  'grep' sans chemin absolu
    char command[512];
    snprintf(command, sizeof(command), "grep -i \"%s\" /opt/neonpulse/scores.db", player_name);
    
    printf("ğŸ”§ Executing: %s\n", command);
    system(command);
    
    printf("âœ… Score validation completed!\n");
    printf("ğŸ“Š Score %d for %s has been processed.\n\n", score, player_name);
}

void check_stats() {
    printf("\nğŸ“ˆ GAME STATISTICS\n");
    printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("ğŸ® Total games played: 1337\n");
    printf("ğŸ† Active players: 42\n");
    printf("â­ Highest score: 999999 (PAC-MAN)\n");
    printf("ğŸ”¥ Most popular game: Galaga\n");
    printf("ğŸ“… Last update: 1985-10-26\n\n");
}

void backup_database() {
    printf("\nğŸ’¾ DATABASE BACKUP MODULE\n");
    printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("ğŸ”„ Initializing backup process...\n");
    
    // VulnÃ©rabilitÃ© : appel Ã  'tar' sans chemin absolu
    printf("ğŸ“¦ Creating archive...\n");
    system("tar -czf /tmp/scores_backup.tar.gz /opt/neonpulse/scores.db");
    
    printf("âœ… Backup completed successfully!\n");
    printf("ğŸ“ Archive saved to: /tmp/scores_backup.tar.gz\n\n");
}

void system_diagnostics() {
    printf("\nğŸ”§ SYSTEM DIAGNOSTICS\n");
    printf("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n");
    printf("ğŸ–¥ï¸  Running system checks...\n");
    
    // VulnÃ©rabilitÃ© : appel Ã  'ps' sans chemin absolu
    printf("ğŸ“Š Active processes:\n");
    system("ps aux | grep -E '(apache|mysql|ssh)' | head -5");
    
    printf("\nğŸ’» System load:\n");
    // VulnÃ©rabilitÃ© : appel Ã  'uptime' sans chemin absolu
    system("uptime");
    
    printf("\nğŸ’½ Disk usage:\n");
    // VulnÃ©rabilitÃ© : appel Ã  'df' sans chemin absolu
    system("df -h | grep -E '(/$|/home)' || echo 'Unable to check disk usage'");
    
    printf("\nâœ… Diagnostics completed!\n\n");
}

int main() {
    setuid(0);
    setgid(0);

    int choice;
    
    print_banner();
    printf("ğŸ” Welcome to NeonPulse Arcade Score Management System\n");
    printf("ğŸ¯ Authenticated as: %s (UID: %d)\n", getenv("USER"), getuid());
    printf("âš¡ System ready for score validation and management.\n\n");
    
    while(1) {
        show_menu();
        scanf("%d", &choice);
        getchar(); // consume newline
        
        switch(choice) {
            case 1:
                validate_score();
                break;
            case 2:
                check_stats();
                break;
            case 3:
                backup_database();
                break;
            case 4:
                system_diagnostics();
                break;
            case 5:
                printf("\nğŸŒŸ Thank you for using NeonPulse Score Validator!\n");
                printf("ğŸ® Keep the retro spirit alive! ğŸ•¹ï¸\n\n");
                exit(0);
            default:
                printf("\nâŒ Invalid option! Please select 1-5.\n\n");
        }
        
        printf("Press Enter to continue...");
        getchar();
        printf("\n");
    }
    
    return 0;
}