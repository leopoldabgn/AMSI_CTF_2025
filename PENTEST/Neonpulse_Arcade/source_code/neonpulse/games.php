<?php
	$page_title = "Games";

	include('include/header.php');
	include('include/functions.php');

	$games = getGames();

	// Check if a specific game was requested
	if (isset($_GET['id'])) {
        $game_id = (int)$_GET['id'];
        $selected_game = null;

        foreach ($games as $game) {
            if ($game['id'] == $game_id) {
                $selected_game = $game;
                break;
            }
        }

	}
	?>
<?php if (isset($selected_game)): ?>
<!-- Display details of a specific game -->
<h2 class="neon-text"><?php echo $selected_game['name']; ?></h2>

<div class="game-detail">

	<img src="<?php echo $selected_game['image']; ?>" alt="<?php echo $selected_game['name']; ?>" class="game-featured-image">

	<div class="game-info">

		<div class="neon-border">
			<p><strong>Year:</strong> <?php echo $selected_game['year']; ?></p>
			<p><strong>Developer:</strong> <?php echo $selected_game['developer']; ?></p>
			<p><strong>High Score:</strong> <?php echo number_format($selected_game['score']); ?></p>
		</div>

		<p><?php echo $selected_game['description']; ?></p>

		<div class="game-controls">
			<h3 class="neon-text-cyan">How to Play</h3>
			<p>Use the arrow keys to move and the space bar for the main action. Some games may use other keys or combinations.</p>
		</div>

		<div style="text-align: center; margin: 30px 0;">
			<a href="#" class="retro-btn-cyan">Play Now</a>
			<a href="highscore.php?game=<?php echo strtolower(str_replace(' ', '', $selected_game['name'])); ?>" class="retro-btn">View Scores</a>
		</div>

	</div>

</div>

<a href="games.php" class="retro-btn">Back to All Games</a>

<?php else: ?>

<!-- Display the list of all games -->
<h2 class="neon-text">Our Arcade Games</h2>

<div class="synthwave-grid">
	<div class="grid-floor"></div>
</div>

<p>Dive into our collection of legendary arcade games from the 80s. Each game has been carefully restored to offer you the most authentic experience possible. Select a game to start playing or learn more!</p>

<div class="game-list">

	<?php foreach($games as $game): ?>

	<div class="game-card neon-border">

		<img src="<?php echo $game['image']; ?>" alt="<?php echo $game['name']; ?>">
		<h3><?php echo $game['name']; ?></h3>
		<p><?php echo $game['year']; ?> - <?php echo $game['developer']; ?></p>
		<a href="games.php?id=<?php echo $game['id']; ?>" class="play-btn">View Details</a>

	</div>

	<?php endforeach; ?>

</div>

<?php endif; ?>

<?php include('include/footer.php'); ?>
